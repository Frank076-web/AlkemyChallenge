{"ast":null,"code":"import _regeneratorRuntime from\"E:/BackUp importante/Aprendiendo dise\\xF1o web/React/challenge/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"E:/BackUp importante/Aprendiendo dise\\xF1o web/React/challenge/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"E:/BackUp importante/Aprendiendo dise\\xF1o web/React/challenge/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{useFormik}from'formik';import*as Yup from'yup';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function Login(){//Una vez logueado, si el usuario intenta volver a la pagina de login, se redirecciona a la pagina principal\nuseEffect(function(){if(localStorage.getItem('token')){alert('Atención ya estás logueado, redirigiendo al home');window.location.href='/';}},[]);var _useState=useState(),_useState2=_slicedToArray(_useState,2),values=_useState2[0],setValues=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isTryingToLogin=_useState4[0],setIsTryingToLogin=_useState4[1];//Manejo de formulario y errores con formik y yup\nvar formik=useFormik({initialValues:{email:'',password:''},validationSchema:Yup.object({email:Yup.string().email('Invalid email').required('The field is required'),password:Yup.string().required('The field is required')}),//Al hacer submit, se guardan los datos del formulario en el state\nonSubmit:function onSubmit(values){// console.log(values);\nsetValues(values);setIsTryingToLogin(true);setTimeout(function(){setIsTryingToLogin(false);},100);}});// console.log(values);\n//Envio de datos si el usuario esta intentando hacer submit\n//Enviar datos al servidor para validar usuario, si es correcto, se guarda el token en el localStorage y se redirecciona a la pagina principal\nuseEffect(function(){var getToken=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!(values&&isTryingToLogin)){_context.next=7;break;}_context.next=4;return axios.post('http://challenge-react.alkemy.org/',values);case 4:response=_context.sent;console.log(response);if(response.data.token){localStorage.setItem('token',response.data.token);//cookie de sesión que expira en cuanto se cierre el navegador para eleminar el token y no poder acceder a la pagina principal sin volver a loguearse\ndocument.cookie='isLoggedIn='+encodeURIComponent(true)+';'+'expires=0';window.location.href='/';}case 7:_context.next=12;break;case 9:_context.prev=9;_context.t0=_context[\"catch\"](0);alert('Error: incorrect username and / or password');case 12:case\"end\":return _context.stop();}}},_callee,null,[[0,9]]);}));return function getToken(){return _ref.apply(this,arguments);};}();getToken();},[values,isTryingToLogin]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-center text-white pt-5\",style:{fontSize:'4rem'},children:\"Login\"}),/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row justify-content-center align-items-center\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-md-6\",children:/*#__PURE__*/_jsx(\"div\",{id:\"login-box\",className:\"col-md-12\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"form\",onSubmit:formik.handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",className:\"text-white\",children:\"Username:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",placeholder:\"Enter your email\",onChange:formik.handleChange,value:formik.values.email,className:\"form-control\"}),formik.errors.email?/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:formik.errors.email}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"text-white\",children:\"Password:\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",name:\"password\",placeholder:\"Enter your password\",onChange:formik.handleChange,value:formik.values.password,className:\"form-control\"}),formik.errors.password?/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-danger\",children:formik.errors.password}):null]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"div\",{className:\"text-center\",children:/*#__PURE__*/_jsx(\"input\",{type:\"submit\",name:\"submit\",className:\"btn btn-info btn-md\",value:\"Send\",style:{width:'50%'}})})]})]})})})})})]});}","map":{"version":3,"sources":["E:/BackUp importante/Aprendiendo diseño web/React/challenge/src/components/login/Login.js"],"names":["React","useEffect","useState","useFormik","Yup","axios","Login","localStorage","getItem","alert","window","location","href","values","setValues","isTryingToLogin","setIsTryingToLogin","formik","initialValues","email","password","validationSchema","object","string","required","onSubmit","setTimeout","getToken","post","response","console","log","data","token","setItem","document","cookie","encodeURIComponent","fontSize","handleSubmit","handleChange","errors","width"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { useFormik } from 'formik';\r\nimport * as Yup from 'yup';\r\nimport axios from 'axios';\r\n\r\nexport default function Login() {\r\n    //Una vez logueado, si el usuario intenta volver a la pagina de login, se redirecciona a la pagina principal\r\n    useEffect(() => {\r\n        if (localStorage.getItem('token')) {\r\n            alert('Atención ya estás logueado, redirigiendo al home');\r\n            window.location.href = '/';\r\n        }\r\n    }, []);\r\n\r\n    const [values, setValues] = useState();\r\n    const [isTryingToLogin, setIsTryingToLogin] = useState(false);\r\n\r\n    //Manejo de formulario y errores con formik y yup\r\n    const formik = useFormik({\r\n        initialValues: {\r\n            email: '',\r\n            password: ''\r\n        },\r\n        validationSchema: Yup.object({\r\n            email: Yup.string()\r\n                .email('Invalid email')\r\n                .required('The field is required'),\r\n            password: Yup.string().required('The field is required')\r\n        }),\r\n\r\n        //Al hacer submit, se guardan los datos del formulario en el state\r\n        onSubmit: (values) => {\r\n            // console.log(values);\r\n            setValues(values);\r\n            setIsTryingToLogin(true);\r\n            setTimeout(() => {\r\n                setIsTryingToLogin(false);\r\n            }, 100);\r\n        }\r\n    });\r\n    // console.log(values);\r\n\r\n    //Envio de datos si el usuario esta intentando hacer submit\r\n    //Enviar datos al servidor para validar usuario, si es correcto, se guarda el token en el localStorage y se redirecciona a la pagina principal\r\n    useEffect(() => {\r\n        const getToken = async () => {\r\n            try {\r\n                if (values && isTryingToLogin) {\r\n                    const response = await axios.post(\r\n                        'http://challenge-react.alkemy.org/',\r\n                        values\r\n                    );\r\n                    console.log(response);\r\n                    if (response.data.token) {\r\n                        localStorage.setItem(\r\n                            'token',\r\n                            response.data.token\r\n                        );\r\n                        //cookie de sesión que expira en cuanto se cierre el navegador para eleminar el token y no poder acceder a la pagina principal sin volver a loguearse\r\n                        document.cookie =\r\n                            'isLoggedIn=' +\r\n                            encodeURIComponent(true) +\r\n                            ';' +\r\n                            'expires=0';\r\n                        window.location.href = '/';\r\n                    }\r\n                }\r\n            } catch (error) {\r\n                alert('Error: incorrect username and / or password');\r\n            }\r\n        };\r\n        getToken();\r\n    }, [values, isTryingToLogin]);\r\n\r\n    return (\r\n        <>\r\n            <h3\r\n                className=\"text-center text-white pt-5\"\r\n                style={{\r\n                    fontSize: '4rem'\r\n                }}\r\n            >\r\n                Login\r\n            </h3>\r\n            <div className=\"container\">\r\n                <div className=\"row justify-content-center align-items-center\">\r\n                    <div className=\"col-md-6\">\r\n                        <div id=\"login-box\" className=\"col-md-12\">\r\n                            <form\r\n                                className=\"form\"\r\n                                onSubmit={formik.handleSubmit}\r\n                            >\r\n                                <div className=\"form-group\">\r\n                                    <label\r\n                                        htmlFor=\"username\"\r\n                                        className=\"text-white\"\r\n                                    >\r\n                                        Username:\r\n                                    </label>\r\n                                    <br />\r\n                                    <input\r\n                                        type=\"email\"\r\n                                        name=\"email\"\r\n                                        placeholder=\"Enter your email\"\r\n                                        onChange={formik.handleChange}\r\n                                        value={formik.values.email}\r\n                                        className=\"form-control\"\r\n                                    />\r\n                                    {formik.errors.email ? (\r\n                                        <div className=\"alert alert-danger\">\r\n                                            {formik.errors.email}\r\n                                        </div>\r\n                                    ) : null}\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    <label\r\n                                        htmlFor=\"password\"\r\n                                        className=\"text-white\"\r\n                                    >\r\n                                        Password:\r\n                                    </label>\r\n                                    <br />\r\n                                    <input\r\n                                        type=\"password\"\r\n                                        name=\"password\"\r\n                                        placeholder=\"Enter your password\"\r\n                                        onChange={formik.handleChange}\r\n                                        value={formik.values.password}\r\n                                        className=\"form-control\"\r\n                                    />\r\n                                    {formik.errors.password ? (\r\n                                        <div className=\"alert alert-danger\">\r\n                                            {formik.errors.password}\r\n                                        </div>\r\n                                    ) : null}\r\n                                </div>\r\n                                <div className=\"form-group\">\r\n                                    {/*                                     <label\r\n                                        for=\"remember-me\"\r\n                                        class=\"text-info\"\r\n                                    >\r\n                                        <span>Remember me</span> \r\n                                        <span>\r\n                                            <input\r\n                                                id=\"remember-me\"\r\n                                                name=\"remember-me\"\r\n                                                type=\"checkbox\"\r\n                                            />\r\n                                        </span>\r\n                                    </label> */}\r\n                                    <br />\r\n                                    <div className=\"text-center\">\r\n                                        <input\r\n                                            type=\"submit\"\r\n                                            name=\"submit\"\r\n                                            className=\"btn btn-info btn-md\"\r\n                                            value=\"Send\"\r\n                                            style={{\r\n                                                width: '50%'\r\n                                            }}\r\n                                        />\r\n                                    </div>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </>\r\n    );\r\n}\r\n"]},"metadata":{},"sourceType":"module"}